{% extends "product/base_shop.html" %}
{% load static i18n %}
{% load crispy_forms_tags %}

{% block title %}
    {% if category %}{{ category.name }} {% else %} Products {% endif %}
{% endblock %}


{% block content %}
{% if product %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-6">
            <div class="product-image">
                {% if product_images|length >= 0 %}
                    {% include './includes/carousel.html' %}
                {% elif  product.default_image %}
                    <img src="{{ product.default_image.url }}" 
                        class="card-img-top" alt="{{ product.product_name }}">
                {% else %}
                    <div class="card-body">
                        <div class="product-image">
                            <img src="{% static 'img/default/large_800x600_plan-apprt.jpg' %}" 
                                alt="{{ product_images }}" 
                                class="rounded-lg img-fluid mx-auto d-block" id="product-image" 
                                style="height:800px; width:600px;">
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="col-md-6">
            <div class="product">
                <h3>{{ product.name }}</h3>
                <h6><a href="{{ product.category.get_absolute_url }}">{{ product.category }}</a></h6>
                <p class="text-muted">Prix : {{ product.price }} DH</p>
                <!-- Specifications du produit -->
                {% for spec in product.options %}  
                    <p class="card-text">{{ spec.name }} : {{ spec.value }}</p>
                {% endfor %}
                <p class="card-text">Description : {{ product.description|safe|linebreaksbr }}</p>

                <!-- action ajouter dans panier -->
                <form action="{% url 'cart:cart_add_item' product.pk %}" method="post">
                    {% csrf_token %}
                    {{ cart_product_form }}
                    <input type="submit" value="ajouter dans le panier" class="btn btn-warning">
                </form>
            </div>
        </div>
    </div><!-- /.row -->

    <!-- Contenu de l'image en plein écran -->
    <div class="fullscreen-image" id="fullscreen-image" style="display: none;">
        <button class="btn btn-success close-btn">&times; close </button>
        <img src="" alt="{{ product.name }}" class="img-fluid">
    </div>
</div><!-- /.container -->

{% block extra_js %}
    <!-- Intégration de jQuery et Bootstrap JS (si nécessaire) -->
    <script>
        $(document).ready(function() {
            var fullscreenImage = $("#fullscreen-image");
            var productImage = $("#product-image");

            productImage.click(function() {
                var src = $(this).attr("src");
                fullscreenImage.find("img").attr("src", src);
                fullscreenImage.show(); // Afficher l'image en plein écran
            });

            $(".close-btn").click(function() {
                fullscreenImage.hide(); // Masquer l'image en plein écran
            });
        });
    </script>
{% endblock %}
{% endif %}
{% endblock content %}

{% block extra_css %}
<style>
/* Personnalisation des styles supplémentaires */
.product-image img {
    width: 100%;
    height: auto;
}
.fullscreen-image {
    display: none; /* Caché par défaut */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
}
.fullscreen-image img {
    max-width: 90%;
    max-height: 90%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
</style>
{% endblock %}

 